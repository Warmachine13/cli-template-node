"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"CreateRepository",{enumerable:true,get:()=>CreateRepository});const _errors=require("../entities/errors/index");const _constants=require("../../constants/index");const _entities=require("../entities/index");const REPOSITORY_PATH="infra/repos/postgres";const REPOSITORY_FACTORY_PATH="main/factories/infra/repos/postgres";class CreateRepository{handle(pathFull,name="Repository",test=true,properites={}){const fileInString=this.fileStorage.readFileString({path:this.pathResolver.pathresolve(__dirname,_constants.PATH_REPOSITORY)});if(fileInString.length===0){throw new _errors.FileNotFound}const titleConversion=new _entities.TitleConversion(name);const UpperCase=titleConversion.GetCamelCaseName();const titleFormated=titleConversion.GetFormatedTitleFileName();const replacedFileString=new _entities.FormatDocument(fileInString,UpperCase,properites).formatDocument();const pathFolder=`${pathFull}/src/${REPOSITORY_PATH}`;const createFile=new _entities.CreateFile(this.fileStorage,this.pathResolver);const pathToWrite=createFile.createFile(pathFolder,replacedFileString,titleFormated);this.logger.log({message:`
 diretorio do repository ${pathToWrite}`});this.fileStorage.appendFile({path:`${pathFolder}/index.ts`,content:`export * from './${titleFormated.replace(".ts","")}'
`});const fileFactoryInString=this.fileStorage.readFileString({path:this.pathResolver.pathresolve(__dirname,_constants.PATH_FACTORY_REPOSITORY)});const replacedFactoryFileString=new _entities.FormatDocument(fileFactoryInString,UpperCase,properites).formatDocument();const pathFactoryFolder=`${pathFull}/src/${REPOSITORY_FACTORY_PATH}`;const createFactoryFile=new _entities.CreateFile(this.fileStorage,this.pathResolver);const pathToFactoryWrite=createFactoryFile.createFile(pathFactoryFolder,replacedFactoryFileString,titleFormated);this.logger.log({message:`
 diretorio do factory repository ${pathToFactoryWrite}`});this.fileStorage.appendFile({path:`${pathFactoryFolder}/index.ts`,content:`export * from './${titleFormated.replace(".ts","")}'
`});const fileInTestString=this.fileStorage.readFileString({path:this.pathResolver.pathresolve(__dirname,_constants.PATH_REPOSITORY_TEST)});if(fileInTestString===""){throw new _errors.CouldNotWrite}if(test){const createFile=new _entities.CreateFile(this.fileStorage,this.pathResolver);const pathTestFolder=`${pathFull}/tests/${REPOSITORY_PATH}`;const testnameFile=titleFormated.replace(".ts",".spec.ts");const replacedFactoryTestFileString=new _entities.FormatDocument(fileInTestString,UpperCase,properites).formatDocument();const pathToWriteTest=createFile.createFile(pathTestFolder,replacedFactoryTestFileString,testnameFile);this.logger.log({message:`
 diretorio da entidade test ${pathToWriteTest}`})}return replacedFileString}constructor(fileStorage,pathResolver,logger){this.fileStorage=fileStorage;this.pathResolver=pathResolver;this.logger=logger}}